<div class="dashboard-container">
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
    <p>Carregando...</p>
  </div>

  <div *ngIf="error" class="error-message">
    <i class="fas fa-exclamation-circle"></i>
    <p>{{ error }}</p>
    <button (click)="loadData()">Tentar novamente</button>
  </div>

  <div *ngIf="!isLoading && !error">
    <div class="welcome-section">
      <h1>Bem-vindo, {{ currentUser?.nome }}</h1>
      <p class="role">{{ getRoleLabel(currentUser?.perfil) }}</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
          <h3>Total de Clientes</h3>
          <p class="stat-value">1,234</p>
          <p class="stat-change positive">
            <i class="fas fa-arrow-up"></i>
            12% este mês
          </p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-content">
          <h3>Serviços Hoje</h3>
          <p class="stat-value">28</p>
          <p class="stat-change">
            <i class="fas fa-clock"></i>
            5 pendentes
          </p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-file-medical"></i>
        </div>
        <div class="stat-content">
          <h3>Serviços este mês</h3>
          <p class="stat-value">856</p>
          <p class="stat-change">
            <i class="fas fa-clock"></i>
            12 para revisar
          </p>
        </div>
      </div>
    </div>

    <div class="appointments-section">
      <div class="section-header">
        <h2>Serviços do Dia</h2>
        <div class="header-actions">
          <button class="action-btn" (click)="navigateToNewConsultation()">
            <i class="fas fa-plus"></i>
            Novo Serviço
          </button>
          <a routerLink="/calendar" class="view-all">Ver todas</a>
        </div>
      </div>
      <div class="appointments-list">
        <div class="appointment-card" *ngFor="let appointment of appointments" (click)="navigateToConsultation(appointment)">
          <div class="appointment-info">
            <h3>{{ appointment.patientName }}</h3>
            <p class="time">Horário: {{ appointment.time }}</p>
            <p class="doctor">Colaborador: {{ appointment.doctor }}</p>
          </div>
          <div class="appointment-status">
            <p class="status-label">Status:</p>
            <select
              [value]="appointment.status"
              (change)="updateStatus(appointment, $event)"
              (click)="$event.stopPropagation()"
            >
              <option value="scheduled">Agendado</option>
              <option value="confirmed">Confirmado</option>
              <option value="completed">Concluído</option>
              <option value="cancelled">Cancelado</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
